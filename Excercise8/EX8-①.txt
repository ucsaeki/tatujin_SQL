EX8-① 結合が先か、集約が先か？

/*年齢、性別、地方ごとの人口を表示する*/

SELECT
	MASTER.age_class,
	MASTER.sex_code,
	SUM(
		CASE
			WHEN
				prefecture_name
			IN
				('青森','秋田')
			THEN
				population
			ELSE
				NULL
		END
	) AS population_tohoku,
	SUM(
		CASE
			WHEN
				prefecture_name
			IN
				('東京','千葉')
			THEN
				population
			ELSE
				NULL
		END
	) AS population_kanto
FROM
	(
		SELECT
			age_class,
			sex_code
		FROM
			ages
		CROSS JOIN
			sexes
	) AS MASTER
LEFT OUTER JOIN
	populations AS p
ON
	p.age_class = MASTER.age_class
AND
	p.sex_code = MASTER.sex_code
GROUP BY
	age_class,
	sex_code DESC
;